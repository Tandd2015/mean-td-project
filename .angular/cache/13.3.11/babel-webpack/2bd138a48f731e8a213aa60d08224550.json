{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { Subscription } from 'rxjs';\nimport { ReviewApp } from '../../models';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services\";\nimport * as i3 from \"@angular/forms\";\nfunction TestimonialNewComponent_div_2_li_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const error_r5 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(error_r5);\n  }\n}\nfunction TestimonialNewComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17);\n    i0.ɵɵelementStart(1, \"ul\", 18);\n    i0.ɵɵtemplate(2, TestimonialNewComponent_div_2_li_2_Template, 2, 1, \"li\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.newReviewErrors);\n  }\n}\nfunction TestimonialNewComponent_img_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 20);\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"src\", ctx_r1.newPickedImage, i0.ɵɵsanitizeUrl)(\"alt\", ctx_r1.newReviewAppForm.value.name);\n  }\n}\nfunction TestimonialNewComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 21);\n  }\n}\nfunction TestimonialNewComponent_button_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 22);\n    i0.ɵɵtext(1, \"Submit\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let TestimonialNewComponent = /*#__PURE__*/(() => {\n  class TestimonialNewComponent {\n    constructor(router, reviewService, formBuilder) {\n      this.router = router;\n      this.reviewService = reviewService;\n      this.formBuilder = formBuilder;\n      this.newReviewsAppSubscription = new Subscription();\n      this.newReviewAppSubscription = new Subscription();\n      this.newReviewAppEnd = new ReviewApp();\n      this.newReviewsAppEnd = [];\n      this.newPickedImage = '';\n      this.newReviewErrors = [];\n      this.newReadonly = false;\n      this.newMax = 5;\n    }\n    ngOnInit() {\n      this.newReviewsAppSubscription = this.reviewService.getSiteReviews().subscribe({\n        next: newReviewsApp => {\n          this.newReviewsAppEnd = newReviewsApp;\n        },\n        error: error => this.handleNewReviewErrors(error.error)\n      });\n      this.newReviewAppForm = this.formBuilder.group({\n        content: [null, [Validators.required, Validators.minLength(1)]],\n        writtenBy: [null, [Validators.required, Validators.minLength(1), Validators.maxLength(360)]],\n        byImage: [null, [Validators.required]],\n        byRating: [null, [Validators.required, Validators.max(5)]]\n      });\n    }\n    onNewPickedImage(event) {\n      const reader = new FileReader();\n      const file = event.target.files[0];\n      this.newSelectedFile = file;\n      reader.readAsDataURL(file);\n      reader.onload = () => {\n        this.newPickedImage = reader.result;\n      };\n    }\n    onNewReviewSubmit() {\n      console.log(this.newReviewAppForm, this.newReviewAppForm.value);\n      this.newReviewAppEnd = this.newReviewAppForm.value;\n      this.newReviewAppSubscription = this.reviewService.createReview(this.newReviewAppEnd, this.newSelectedFile).subscribe({\n        next: newReviewApp => {\n          this.newReviewsAppEnd = [...this.newReviewsAppEnd, newReviewApp];\n          console.log('Submitted a New Review.', newReviewApp, this.newReviewAppEnd, this.newReviewsAppEnd);\n          this.newReviewAppForm.reset();\n          this.router.navigateByUrl('/home/dash');\n        },\n        error: error => {\n          this.handleNewReviewErrors(error.error);\n        }\n      });\n    }\n    handleNewReviewErrors(errors) {\n      this.newReviewErrors = Array.isArray(errors) ? errors : [errors];\n    }\n    ngOnDestroy() {\n      this.newReviewsAppSubscription.unsubscribe();\n      this.newReviewAppSubscription.unsubscribe();\n    }\n  }\n  TestimonialNewComponent.ɵfac = function TestimonialNewComponent_Factory(t) {\n    return new (t || TestimonialNewComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ReviewService), i0.ɵɵdirectiveInject(i3.FormBuilder));\n  };\n  TestimonialNewComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TestimonialNewComponent,\n    selectors: [[\"app-testimonial-new\"]],\n    decls: 32,\n    vars: 7,\n    consts: [[\"class\", \"row\", 4, \"ngIf\"], [\"enctype\", \"multipart/form-data\", \"autocomplete\", \"off\", 3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\", \"row\"], [\"for\", \"content\", 1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"type\", \"text\", \"name\", \"content\", \"formControlName\", \"content\", \"minlength\", \"1\", \"required\", \"\", 1, \"form-control\", \"col-md-5\", \"incline\"], [\"for\", \"writtenBy\", 1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"type\", \"text\", \"name\", \"writtenBy\", \"formControlName\", \"writtenBy\", \"minlength\", \"1\", \"maxlength\", \"360\", \"required\", \"\", 1, \"form-control\", \"col-md-5\", \"incline\"], [1, \"image-preview\", \"row\"], [3, \"src\", \"alt\", 4, \"ngIf\"], [\"class\", \"\", 4, \"ngIf\"], [1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"for\", \"byImage\", 1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"type\", \"file\", \"name\", \"byImage\", \"formControlName\", \"byImage\", \"required\", \"\", 1, \"form-control\", \"col-md-5\", \"incline\", 3, \"change\"], [\"for\", \"byRating\", 1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"formControlName\", \"byRating\", \"id\", \"byRating\", \"name\", \"byRating\", \"required\", \"\", 3, \"readonly\", \"max\"], [\"class\", \"btn btn-primary\", 4, \"ngIf\"], [\"routerLink\", \"/admin/dash\", 1, \"btn\", \"btn-outline-info\"], [1, \"row\"], [1, \"alert\", \"alert-danger\"], [4, \"ngFor\", \"ngForOf\"], [3, \"src\", \"alt\"], [1, \"\"], [1, \"btn\", \"btn-primary\"]],\n    template: function TestimonialNewComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\");\n        i0.ɵɵelementStart(1, \"fieldset\");\n        i0.ɵɵtemplate(2, TestimonialNewComponent_div_2_Template, 3, 1, \"div\", 0);\n        i0.ɵɵelementStart(3, \"legend\");\n        i0.ɵɵtext(4, \"New Review\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"form\", 1);\n        i0.ɵɵlistener(\"ngSubmit\", function TestimonialNewComponent_Template_form_ngSubmit_5_listener() {\n          return ctx.onNewReviewSubmit();\n        });\n        i0.ɵɵelementStart(6, \"div\", 2);\n        i0.ɵɵelementStart(7, \"label\", 3);\n        i0.ɵɵtext(8, \"Review Content: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(9, \"input\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 2);\n        i0.ɵɵelementStart(11, \"label\", 5);\n        i0.ɵɵtext(12, \"Review Written By: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(13, \"input\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"div\", 7);\n        i0.ɵɵtemplate(15, TestimonialNewComponent_img_15_Template, 1, 2, \"img\", 8);\n        i0.ɵɵtemplate(16, TestimonialNewComponent_div_16_Template, 1, 0, \"div\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"div\", 2);\n        i0.ɵɵelementStart(18, \"p\", 10);\n        i0.ɵɵtext(19, \"User Review Image\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"div\", 2);\n        i0.ɵɵelementStart(21, \"label\", 11);\n        i0.ɵɵtext(22, \"Choose file\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"input\", 12);\n        i0.ɵɵlistener(\"change\", function TestimonialNewComponent_Template_input_change_23_listener($event) {\n          return ctx.onNewPickedImage($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"div\", 2);\n        i0.ɵɵelementStart(25, \"label\", 13);\n        i0.ɵɵtext(26, \"Review Written By Rating: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(27, \"ngb-rating\", 14);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"div\", 2);\n        i0.ɵɵtemplate(29, TestimonialNewComponent_button_29_Template, 2, 0, \"button\", 15);\n        i0.ɵɵelementStart(30, \"button\", 16);\n        i0.ɵɵtext(31, \"Cancel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.newReviewErrors.length);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"formGroup\", ctx.newReviewAppForm);\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngIf\", ctx.newPickedImage !== \"\" && ctx.newPickedImage);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.newPickedImage === \"\");\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"readonly\", ctx.newReadonly)(\"max\", ctx.newMax);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.newReviewAppForm.valid);\n      }\n    },\n    styles: [\"\"]\n  });\n  return TestimonialNewComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}