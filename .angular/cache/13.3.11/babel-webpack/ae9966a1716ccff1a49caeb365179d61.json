{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { map, switchMap } from 'rxjs/operators';\nimport { Subscription } from 'rxjs';\nimport { PostApp } from '../../models';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/post.service\";\nimport * as i3 from \"@angular/forms\";\nfunction PostEditComponent_div_2_li_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const error_r8 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(error_r8);\n  }\n}\nfunction PostEditComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵelementStart(1, \"ul\", 28);\n    i0.ɵɵtemplate(2, PostEditComponent_div_2_li_2_Template, 2, 1, \"li\", 29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.postEditErrors);\n  }\n}\nfunction PostEditComponent_img_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 30);\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"src\", ctx_r1.editPostPickedImage, i0.ɵɵsanitizeUrl)(\"alt\", ctx_r1.postAppEditForm.value.mainImage);\n  }\n}\nfunction PostEditComponent_div_33_img_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 16);\n  }\n  if (rf & 2) {\n    const editPPI_r10 = ctx.$implicit;\n    const i_r11 = ctx.index;\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵpropertyInterpolate(\"alt\", ctx_r9.editSelectedPostFiles[i_r11].name);\n    i0.ɵɵproperty(\"src\", editPPI_r10, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction PostEditComponent_div_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵtemplate(1, PostEditComponent_div_33_img_1_Template, 1, 2, \"img\", 20);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.editPostPickedImages);\n  }\n}\nfunction PostEditComponent_img_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 16);\n  }\n  if (rf & 2) {\n    const editPPostImages_r12 = ctx.$implicit;\n    const i_r13 = ctx.index;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵpropertyInterpolate(\"src\", editPPostImages_r12, i0.ɵɵsanitizeUrl);\n    i0.ɵɵpropertyInterpolate1(\"alt\", \"The posts images image \", ctx_r3.postAppEdit.images[i_r13].filename, \".\");\n  }\n}\nfunction PostEditComponent_div_43_video_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"video\", 32);\n    i0.ɵɵelement(1, \"source\", 33);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const editPPV_r15 = ctx.$implicit;\n    const i_r16 = ctx.index;\n    const ctx_r14 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"type\", ctx_r14.editSelectedPostFilesV[i_r16].type);\n    i0.ɵɵproperty(\"src\", editPPV_r15, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction PostEditComponent_div_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31);\n    i0.ɵɵtemplate(1, PostEditComponent_div_43_video_1_Template, 2, 2, \"video\", 24);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.editPostPickedVideos);\n  }\n}\nfunction PostEditComponent_video_52_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"video\", 32);\n    i0.ɵɵelement(1, \"source\", 33);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const editPPostVideos_r17 = ctx.$implicit;\n    const i_r18 = ctx.index;\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"type\", ctx_r5.postAppEdit.videos[i_r18].contentType);\n    i0.ɵɵproperty(\"src\", editPPostVideos_r17, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction PostEditComponent_button_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 34);\n    i0.ɵɵtext(1, \"Submit\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let PostEditComponent = /*#__PURE__*/(() => {\n  class PostEditComponent {\n    constructor(route, postService, router, formBuilder) {\n      this.route = route;\n      this.postService = postService;\n      this.router = router;\n      this.formBuilder = formBuilder;\n      this.postAppEditSubscription = new Subscription();\n      this.postsAppEditSubscription = new Subscription();\n      this.postAppEdit = new PostApp();\n      this.postsAppEdit = [];\n      this.postEditErrors = [];\n      this.editPostPickedImage = '';\n      this.editSelectedPostFilesL = [];\n      this.editPostPickedImages = [];\n      this.editSelectedPostFilesVL = [];\n      this.editPostPickedVideos = [];\n    }\n    ngOnInit() {\n      this.postAppEditSubscription = this.route.paramMap.pipe(map(params => params.get('id')), switchMap(id => this.postService.getPost(id))).subscribe({\n        next: postAppEdit => {\n          this.postAppEdit = postAppEdit;\n        },\n        error: error => this.handlePostEditErrors(error.error.message)\n      });\n      this.postAppEditForm = this.formBuilder.group({\n        content: [null, Validators.minLength(1)],\n        category: [null, [Validators.minLength(1), Validators.maxLength(360)]],\n        writtenBy: [null, [Validators.minLength(1), Validators.maxLength(360)]],\n        likes: null,\n        mainImage: null,\n        images: null,\n        videos: null\n      });\n    }\n    onEditPPickedImage(event) {\n      const reader = new FileReader();\n      const file = event.target.files[0];\n      this.editSelectedPostFile = file;\n      reader.readAsDataURL(file);\n      reader.onload = () => {\n        this.editPostPickedImage = reader.result;\n      };\n    }\n    onEditPPickedImages(event) {\n      this.editPostPickedImages = [];\n      this.editSelectedPostFilesL = [];\n      this.editSelectedPostFiles = event.target.files;\n      console.log(this.editSelectedPostFiles, event.target);\n      for (let i = 0; i < this.editSelectedPostFiles.length; i++) {\n        let file = event.target.files[i];\n        this.editSelectedPostFilesL.push(file);\n        const reader = new FileReader();\n        reader.readAsDataURL(file);\n        reader.onload = () => {\n          this.editPostPickedImages.push(reader.result);\n        };\n      }\n    }\n    onEditPPickedVideos(event) {\n      this.editPostPickedVideos = [];\n      this.editSelectedPostFilesVL = [];\n      this.editSelectedPostFilesV = event.target.files;\n      for (let i = 0; i < this.editSelectedPostFilesV.length; i++) {\n        let file = event.target.files[i];\n        this.editSelectedPostFilesVL.push(file);\n        const reader = new FileReader();\n        reader.readAsDataURL(file);\n        reader.onload = () => {\n          this.editPostPickedVideos.push(reader.result);\n        };\n      }\n    }\n    onEditPostSubmit() {\n      let thisV = [this.editSelectedPostFile, this.editSelectedPostFilesL, this.editSelectedPostFilesVL];\n      console.log(this.postAppEdit, thisV);\n      this.postAppEditForm.value.content = this.postAppEditForm.value.content === null ? this.postAppEdit.content : this.postAppEditForm.value.content;\n      this.postAppEditForm.value.category = this.postAppEditForm.value.category === null ? this.postAppEdit.category : this.postAppEditForm.value.category;\n      this.postAppEditForm.value.writtenBy = this.postAppEditForm.value.writtenBy === null ? this.postAppEdit.writtenBy : this.postAppEditForm.value.writtenBy;\n      this.postAppEditForm.value.likes = this.postAppEditForm.value.likes === null ? this.postAppEdit.likes : this.postAppEditForm.value.likes;\n      this.postAppEditForm.value.newObject = JSON.stringify(this.postAppEdit);\n      this.postAppEditSubscription = this.postService.updatePost(Object.assign(Object.assign({}, this.postAppEditForm.value), {\n        _id: this.postAppEdit._id\n      }), thisV).subscribe({\n        next: updatedPostAppEdit => {\n          this.postsAppEditSubscription = this.postService.getSitePosts().subscribe({\n            next: postsAppEdit => {\n              this.postsAppEdit = postsAppEdit;\n              this.router.navigateByUrl('admin/dash');\n            },\n            error: error => this.handlePostEditErrors(error.error.message)\n          });\n        },\n        error: error => this.handlePostEditErrors(error.error)\n      });\n    }\n    handlePostEditErrors(errors) {\n      this.postEditErrors = Array.isArray(errors) ? errors : [errors];\n    }\n    ngOnDestroy() {\n      this.postAppEditSubscription.unsubscribe();\n      this.postsAppEditSubscription.unsubscribe();\n    }\n  }\n  PostEditComponent.ɵfac = function PostEditComponent_Factory(t) {\n    return new (t || PostEditComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.PostService), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i3.FormBuilder));\n  };\n  PostEditComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PostEditComponent,\n    selectors: [[\"app-post-edit\"]],\n    decls: 57,\n    vars: 14,\n    consts: [[\"class\", \"row\", 4, \"ngIf\"], [\"enctype\", \"multipart/form-data\", \"autocomplete\", \"off\", 3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\", \"row\"], [\"for\", \"content\", 1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"type\", \"text\", \"name\", \"content\", \"formControlName\", \"content\", \"minlength\", \"1\", 1, \"form-control\", \"col-md-5\", \"incline\", 3, \"placeholder\"], [\"for\", \"category\", 1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"type\", \"text\", \"name\", \"category\", \"formControlName\", \"category\", \"minlength\", \"1\", \"maxlength\", \"360\", 1, \"form-control\", \"col-md-5\", \"incline\", 3, \"placeholder\"], [\"for\", \"writtenBy\", 1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"type\", \"text\", \"name\", \"writtenBy\", \"formControlName\", \"writtenBy\", \"minlength\", \"1\", \"maxlength\", \"360\", 1, \"form-control\", \"col-md-5\", \"incline\", 3, \"placeholder\"], [\"for\", \"likes\", 1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"type\", \"number\", \"name\", \"likes\", \"formControlName\", \"likes\", 1, \"form-control\", \"col-md-5\", \"incline\", 3, \"placeholder\"], [1, \"image-preview\", \"row\"], [\"class\", \"postFileSize\", \"title\", \"Current User Post Image\", 3, \"src\", \"alt\", 4, \"ngIf\"], [1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"for\", \"mainImage\", 1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"title\", \"User Post Image\", \"placeholder\", \"User Post Image\", \"type\", \"file\", \"name\", \"mainImage\", \"formControlName\", \"mainImage\", 1, \"form-control\", \"col-md-5\", \"incline\", 3, \"change\"], [1, \"postFileSize\", 3, \"src\", \"alt\"], [\"class\", \"image-preview row\", 4, \"ngIf\"], [\"for\", \"images\", 1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"title\", \"Post Images\", \"placeholder\", \"Post Images\", \"type\", \"file\", \"multiple\", \"\", \"name\", \"images\", \"formControlName\", \"images\", 1, \"form-control\", \"col-md-5\", \"incline\", 3, \"change\"], [\"class\", \"postFileSize\", 3, \"src\", \"alt\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"video-preview row\", 4, \"ngIf\"], [\"for\", \"videos\", 1, \"col-md-1\", \"col-form-label\", \"incline\"], [\"title\", \"Post Videos\", \"placeholder\", \"Post Videos\", \"type\", \"file\", \"multiple\", \"\", \"name\", \"videos\", \"formControlName\", \"videos\", 1, \"form-control\", \"col-md-5\", \"incline\", 3, \"change\"], [\"class\", \"video postFileSize\", \"controls\", \"\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"btn btn-primary\", 4, \"ngIf\"], [\"routerLink\", \"/admin/dash\", 1, \"btn\", \"btn-outline-info\"], [1, \"row\"], [1, \"alert\", \"alert-danger\"], [4, \"ngFor\", \"ngForOf\"], [\"title\", \"Current User Post Image\", 1, \"postFileSize\", 3, \"src\", \"alt\"], [1, \"video-preview\", \"row\"], [\"controls\", \"\", 1, \"video\", \"postFileSize\"], [3, \"src\", \"type\"], [1, \"btn\", \"btn-primary\"]],\n    template: function PostEditComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\");\n        i0.ɵɵelementStart(1, \"fieldset\");\n        i0.ɵɵtemplate(2, PostEditComponent_div_2_Template, 3, 1, \"div\", 0);\n        i0.ɵɵelementStart(3, \"legend\");\n        i0.ɵɵtext(4, \"Edit Post\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"form\", 1);\n        i0.ɵɵlistener(\"ngSubmit\", function PostEditComponent_Template_form_ngSubmit_5_listener() {\n          return ctx.onEditPostSubmit();\n        });\n        i0.ɵɵelementStart(6, \"div\", 2);\n        i0.ɵɵelementStart(7, \"label\", 3);\n        i0.ɵɵtext(8, \"Post Content: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(9, \"input\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 2);\n        i0.ɵɵelementStart(11, \"label\", 5);\n        i0.ɵɵtext(12, \"Post Category: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(13, \"input\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"div\", 2);\n        i0.ɵɵelementStart(15, \"label\", 7);\n        i0.ɵɵtext(16, \"Post Written By: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(17, \"input\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"div\", 2);\n        i0.ɵɵelementStart(19, \"label\", 9);\n        i0.ɵɵtext(20, \"Post Likes: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(21, \"input\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"div\", 11);\n        i0.ɵɵtemplate(23, PostEditComponent_img_23_Template, 1, 2, \"img\", 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"div\", 2);\n        i0.ɵɵelementStart(25, \"p\", 13);\n        i0.ɵɵtext(26, \"User Post Image\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"div\", 2);\n        i0.ɵɵelementStart(28, \"label\", 14);\n        i0.ɵɵtext(29, \"Choose file\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"input\", 15);\n        i0.ɵɵlistener(\"change\", function PostEditComponent_Template_input_change_30_listener($event) {\n          return ctx.onEditPPickedImage($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"div\", 2);\n        i0.ɵɵelement(32, \"img\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(33, PostEditComponent_div_33_Template, 2, 1, \"div\", 17);\n        i0.ɵɵelementStart(34, \"div\", 2);\n        i0.ɵɵelementStart(35, \"p\", 13);\n        i0.ɵɵtext(36, \"Post Images\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"div\", 2);\n        i0.ɵɵelementStart(38, \"label\", 18);\n        i0.ɵɵtext(39, \"Choose files\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"input\", 19);\n        i0.ɵɵlistener(\"change\", function PostEditComponent_Template_input_change_40_listener($event) {\n          return ctx.onEditPPickedImages($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"div\", 2);\n        i0.ɵɵtemplate(42, PostEditComponent_img_42_Template, 1, 2, \"img\", 20);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(43, PostEditComponent_div_43_Template, 2, 1, \"div\", 21);\n        i0.ɵɵelementStart(44, \"div\", 2);\n        i0.ɵɵelementStart(45, \"p\", 13);\n        i0.ɵɵtext(46, \"Post Videos\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(47, \"div\", 2);\n        i0.ɵɵelementStart(48, \"label\", 22);\n        i0.ɵɵtext(49, \"Choose files\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"input\", 23);\n        i0.ɵɵlistener(\"change\", function PostEditComponent_Template_input_change_50_listener($event) {\n          return ctx.onEditPPickedVideos($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(51, \"div\", 2);\n        i0.ɵɵtemplate(52, PostEditComponent_video_52_Template, 2, 2, \"video\", 24);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(53, \"div\", 2);\n        i0.ɵɵtemplate(54, PostEditComponent_button_54_Template, 2, 0, \"button\", 25);\n        i0.ɵɵelementStart(55, \"button\", 26);\n        i0.ɵɵtext(56, \"Cancel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.postEditErrors.length);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"formGroup\", ctx.postAppEditForm);\n        i0.ɵɵadvance(4);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.postAppEdit.content);\n        i0.ɵɵadvance(4);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.postAppEdit.category);\n        i0.ɵɵadvance(4);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.postAppEdit.writtenBy);\n        i0.ɵɵadvance(4);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.postAppEdit.likes);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.editPostPickedImage !== \"\" && ctx.editPostPickedImage);\n        i0.ɵɵadvance(9);\n        i0.ɵɵpropertyInterpolate(\"src\", ctx.postAppEdit.mainImagePath, i0.ɵɵsanitizeUrl);\n        i0.ɵɵpropertyInterpolate1(\"alt\", \"The posts user image \", ctx.postAppEdit == null ? null : ctx.postAppEdit.mainImage == null ? null : ctx.postAppEdit.mainImage.filename, \".\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.editPostPickedImages.length !== 0 && ctx.editPostPickedImages);\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngForOf\", ctx.postAppEdit.imagesPaths);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.editPostPickedVideos.length !== 0 && ctx.editPostPickedVideos);\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngForOf\", ctx.postAppEdit.videosPaths);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.postAppEditForm.valid);\n      }\n    },\n    styles: [\".postFileSize[_ngcontent-%COMP%]{height:20rem;width:20rem}\"]\n  });\n  return PostEditComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}